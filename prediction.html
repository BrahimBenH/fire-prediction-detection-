<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prediction</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header class="header">
        <h1>Fire Prediction</h1>
        <p>View predicted fire locations and their risk levels.</p>
    </header>
    <nav class="navbar">
        <ul>
            <li><a href="prediction.html" class="active">Prediction</a></li>
            <li><a href="detection.html">Detection</a></li>
            <li><a href="report.html">Reports</a></li>
        </ul>
    </nav>
    <main class="main-content">
        <!-- Predicted Fire Locations -->
        <section id="predictions-section" class="card">
            <h2>Predicted Fire Locations</h2>
            <div id="cards-container" class="cards-container">
                <!-- Cards will be generated here by JavaScript -->
            </div>
        </section>

        <!-- Risk Map -->
        <section id="map-section" class="card">
            <h2>Risk Map</h2>
            <div id="map"></div>
        </section>

        <!-- Risk Analytics -->
        <section id="risk-analytics-section" class="card">
            <h2>Risk Analytics</h2>
            <div class="analytics-grid">
                <div class="analytics-card">
                    <h3>Risk Factors</h3>
                    <canvas id="riskFactors"></canvas>
                </div>
                <div class="analytics-card">
                    <h3>Risk Trend</h3>
                    <canvas id="riskTrend"></canvas>
                </div>
            </div>
        </section>
    </main>
    
    <footer class="footer">
        <p>Â© 2024 Fire Prediction App. Powered by AI.</p>
    </footer>
    
    <script>
        // Initialize Leaflet map
        var map = L.map('map').setView([34.0522, -118.2437], 6); // Initial coordinates (Los Angeles)
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19
        }).addTo(map);

        // Example predicted locations with lat, lng, and risk level
        var predictedLocations = [
            { lat: 34.0522, lng: -118.2437, name: "Los Angeles", risk: "High" },
            { lat: 36.7783, lng: -119.4179, name: "California", risk: "Moderate" },
            { lat: 37.7749, lng: -122.4194, name: "San Francisco", risk: "Low" }
        ];

        // Generate cards dynamically for each predicted location
        var cardsContainer = document.getElementById('cards-container');
        predictedLocations.forEach(function(location) {
            var card = document.createElement('div');
            card.classList.add('prediction-card');
            card.innerHTML = `
                <h3>${location.name}</h3>
                <p>Risk Level: ${location.risk}</p>
            `;
            // Add event listener to zoom the map when the card is clicked
            card.addEventListener('click', function() {
                map.setView([location.lat, location.lng], 10); // Zoom in on the clicked location
                L.marker([location.lat, location.lng])
                    .addTo(map)
                    .bindPopup(`${location.name}<br>Risk: ${location.risk}`)
                    .openPopup();
            });
            cardsContainer.appendChild(card);
        });

        // Create initial markers on the map for the predicted locations
        predictedLocations.forEach(function(location) {
            L.marker([location.lat, location.lng])
                .addTo(map)
                .bindPopup(`${location.name}<br>Risk: ${location.risk}`);
        });

        // Initialize Risk Factors Radar Chart
        new Chart(document.getElementById('riskFactors').getContext('2d'), {
            type: 'radar',
            data: {
                labels: ['Temperature', 'Wind', 'Humidity', 'Vegetation', 'Terrain'],
                datasets: [{
                    label: 'Current Risk Factors',
                    data: [80, 65, 70, 85, 60],
                    backgroundColor: 'rgba(255, 87, 34, 0.2)',
                    borderColor: '#FF5722',
                    pointBackgroundColor: '#FF5722'
                }]
            },
            options: {
                responsive: true,
                scales: {
                    r: {
                        min: 0,
                        max: 100,
                        ticks: { display: false }
                    }
                }
            }
        });

        // Initialize Risk Trend Line Chart
        new Chart(document.getElementById('riskTrend').getContext('2d'), {
            type: 'line',
            data: {
                labels: ['00:00', '06:00', '12:00', '18:00', '24:00'],
                datasets: [{
                    label: 'Risk Level',
                    data: [30, 45, 75, 65, 45],
                    borderColor: '#FF5722',
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100
                    }
                }
            }
        });

        // Highlight active navbar link
        const navLinks = document.querySelectorAll('.navbar a');
        navLinks.forEach(link => {
            if (link.href === window.location.href) {
                link.classList.add('active');
            }
        });
    </script>
</body>
</html>
